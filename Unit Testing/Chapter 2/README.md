## 2장 단위 테스트란 무엇인가?

단위 테스트의 정의에는 놀랄 만큼 뉘앙스가 있다. 이러한 뉘앙스는 생각보다 훨씬 중요하다. 해석의 차이가 생겼고, 단위 테스트에 접근하는 방법이 두 가지 뚜렷한 견해로 나뉘었다.

이러한 두 가지 견해는 각각 '고전파(classical school)'과 '런던파(London school)'로 알려져 있다.

### 2.1 '단위 테스트'의 정의

단위 테스트는

- 작은 코드 조각을 검증하고,
- 빠르게 수행하고,
- 격리된 방식으로 처리하는 자동화된 테스트다.

처음 두 속성은 논란의 여지가 없다.

대중의 의견이 크게 다른 것은 세 번째 속성이다. 격리 문제는 단위 테스트의 고전파와 런던파를 구분할 수 있게 해주는 근원적 차이에 속한다.

#### 2.1.1 격리 문제에 대한 런던파의 접근

런던파에서는 테스트 대상 시스템을 협력자에게서 격리하는 것을 일컫는다. 즉, 하나의 클래스가 다른 클래스 또는 여러 클래스에 의존하면 이 모든 의존성을 테스트 대역으로 대체해야 한다.

테스트 대역 사용의 이점

- 테스트가 실패하면 어느 부분이 고장 났는지 확실히 알 수 있다.
- 객체 그래프를 분할할 수 있다. 단위 테스트에서 준비를 크게 줄일 수 있다.
- 한 번에 한 클래스만 테스트하라는 지침을 도입하면 전체 단위 테스트 스위트를 간단한 구조로 할 수 있다.

예제 코드로 보는 고전파와 런던파

- [고전파 예제 코드](codes/Listing1/CustomerTests.cs)에서 Customer가 테스트 대상, Store는 협력자다.
- 고전파 예제 코드는 Customer, Store 둘 다 효과적으로 검증한다. 그러나 Customer가 올바르게 작동하더라도 Store 내부에 버그가 있으면 단위 테스트에 실패할 수 있다. 테스트에서 두 클래스는 격리돼 있지 않다.
- [런던파 예제 코드](codes/Listing2/CustomerTests.cs)에서 협력자인 Store에 테스트 대역을 사용한다.
- 런던파 예제 코드에서 Customer는 Store와 격리돼 있다.
- 고전파 예제 코드는 상점 상태를 검증한다. 반면 런던파 예제 코드는 Customer와 Store 간의 상호 작용을 검사한다.
