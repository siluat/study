# Chapter 8 서버에 정보 보내기

## 이론 학습

### 폼(Form)의 동작 방식

- 사용자가 폼을 submit하면 브라우저는 폼 필드에서 이름-값 쌍을 수집하여 HTTP POST 요청에 넣어 폼의 action 속성에 정의된 URL로 전송한다.
- 폼을 구현하는 것은 HTTP POST를 구현하는 것부터 input 엘리먼트를 그리는 새 레이아웃 객체 말고도 버튼 클릭 처리까지 브라우저의 많은 부분을 확장해야 한다.

## 실습

- `<input>` 태그를 위한 입력창과 `<button>` 태그를 위한 버튼 구현을 위한 InputLayout 클래스 구현
  - 새로운 레이아웃 객체를 추가하는 것은 브라우저를 확장하는 일반적인 방법 중 하나이다.
  - TextLayout를 복제하고 필요한 부분을 변경하여 구현한다.
  - TextLayout가 달리 word 인수가 필요 없다.
  - 고정된 너비를 사용한다. 실습 브라우저에서는 해당 너비를 200px로 정의한다.
  - input 엘리먼트와 button 엘리먼트는 사용자가 식별할 수 있도록 가시성을 고려해야 한다. 해당 요소에 대한 실습 브라우저만의 기본 스타일을 정의한다.
  - paint 메서드에 기본 스타일로 정의한 배경색을 그리기 위한 커맨트 생성을 추가한다.
  - paint 메서드에 텍스트 콘텐츠를 그리기 위한 커맨트 생성을 추가한다.
    - input 태그의 경우 value 속성값을 텍스트 콘텐츠로 사용한다.
    - button 태그의 경우 자식 텍스트 노드의 텍스트 값을 사용한다. button 태그의 경우 자식 요소로 복잡한 HTML이 존재할 수도 있다. 실습 브라우저에서는 하나의 텍스트 노드만 처리하고, 그 외에는 무시하도록 구현한다. 실제 브라우저는 inline-block 디스플레이 모드를 지원한다.
- BlockLayout에서 InputLayout 생성을 처리
  - InputLayout 객체를 초기화하는 input 메서드를 추가한다.
    - input 메서드는 새로 추가할 InputLayout 객체의 너비를 기준으로 줄바꿈 필요 여부를 계산하고 필요에 따라 줄바꿈 메서드를 호출한다.
    - 폰트 스타일을 참조하여 현재 생성한 InputLayout 객체 다음 요소의 x 위치를 계산하여 현재 BlockLayout 객체의 cursor_x 필드값을 업데이트한다.
  - recurse 메서드에 input 및 button 태그 탐색시 input 메서드를 호출해서 InputLayout 객체를 추가한다.
  - 레이아웃 모드 메서드 변경
    - 지금까지의 구현에서는 자식노드가 없다면 레이아웃 모드를 블록 모드로 판단했다. 하지만 input 엘리먼트는 자식이 없지만 인라인 모드로 처리해야 한다. 해당 조건문을 추가하여 인라인 모드로 처리한다.
    - button 엘리먼트는 자식이 존재하지만 특별 취급이 필요하다.
      - 이런 요소가 어토믹(atomic) 인라인 레벨 박스의 예이다.
  - should_paint 메서드 추가
    - 블록 형제 노드가 있을 경우 input이나 button 엘리먼트는 때때로 내부에 InputLayout을 만드는 BlockLayout을 만든다. 이 경우 배경을 두 번 칠하는 문제가 있는데 이를 회피하기 위해 should_paint 메서드를 추가하여 해당 상황의 BlockLayout의 경우 배경색 그리기를 건너뛰게 처리한다.
    - 다른 레이아웃 객체에도 should_paint를 추가하고 해당 메서드는 True를 반환한다.
    - paint_tree 함수는 should_paint 메서드를 확인하여 해당 레이아웃 객체의 페인트 처리 여부를 결정한다.
